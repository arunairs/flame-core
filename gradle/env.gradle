import cn.blinkmind.flame.gradle.external.Component
import cn.blinkmind.flame.gradle.util.Environment
import cn.blinkmind.flame.gradle.TaskGroup

task externalEnv(group: TaskGroup.CONFIG) {
    Environment env = new Environment()
    env.addProperties(rootProject.file('gradle.properties').newDataInputStream())
    rootProject.ext.env = env
}

task componentEnv(group: TaskGroup.SERVER, dependsOn: ['externalEnv'], description: 'set external component environment') {
    ext.components = new HashMap<String, Component>()
    ext.add = { String name, Component component ->
        ext.components.put(name, component)
        logger.lifecycle "Configure new external component:${name}."
    }
    ext.get = { String name ->
        return ext.components[name]
    }
}